<% content_for :page_title do%>Contribute for apartments reviews, photos, units, amenities and rent information<%end %>
<div class="tables contribute" style="padding: 0px 20px;">
	<div class="row">
		<%#= render partial: 'layouts/shared/contribution_for' %>
		<!-- <div class="row"> -->
			<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
				<div class="panel-heading">
					<h2>Your Next Review Awaits</h2>
					<h4>Share your NYC apartment experience with the community</h4>
				</div>
	  		
	  		<div class="panel-body">
					<div id="search-form" class="<%= params[:results].present? ? 'hide' : '' %>">
						<%= form_tag '/reviews/new', method: :get, id: 'search_item_form', class: 'form-horizontal' do %>
		        	<!-- adding value on the basis of selected radio button -->
							<h2>Find your building</h2>
		        	<%= hidden_field_tag :contribution, 'building_review', class: 'form-control building_contribution', id: 'building_contribution' %>
		        	
		        	<%= hidden_field_tag :user_id, current_user.present? ? current_user.id : '' %>
							
							<section class="app-content">
						    <div class="buildings-search">
					      	<%= text_field_tag 'buildings-search-txt', @building.present? ? @building.building_street_address : nil, class: 'form-control', placeholder: 'Search building by name or address', 'data-buildingid' => @building.present? ? @building.id : '', required: 'required' %>
					      	<%= hidden_field_tag 'zip', @building.present? ? @building.zipcode : '' %>
					      	<div class="results" id="buildings-search-results" style="position: relative;">
					      		<div class="no-match-link hidden"><span class="address"><b>Building Not Here?</b></span> <a href="javascript:void(0);" id="add_new_building" class="add_new_building"> Add a building</a></div>
					      	</div>
					      	<ul id="buildings-search-no-results" class="search-no-result"></ul>
						    </div>
					  	</section>

					  	<div class="pull-right next_btn_container">
						  	<% if params[:contribution_for].blank? %>
						  		<!-- when wrong building is selected -->
						  		<%= link_to 'Next','javascript:;', id: 'next_to_review_btn', class: 'btn btn-primary add_new_building' %>
						  		<!-- when correct building is selected -->
						  		<p></p>
						  		<%= submit_tag 'Next', id: 'next_btn', class: 'btn btn-primary hidden' %>
						  	<%end%>
				    	</div>
				  	<%end%>
				    <div class="buildings-search unit-search" style="margin-top: 10px;">
		   				<div class="form-group">
					      <% unless @building.present? %>
					      	<%= text_field_tag 'units-search-txt', nil, class: 'form-control unit-search hide', placeholder: 'Search unit number'%>
					      <%else%>
					      	<%= text_field_tag 'units-search-txt', nil, class: 'form-control unit-search', placeholder: 'Search unit number'%>
					      <%end%>
				      </div>
			      	<div class="results" id="units-search-results"></div>
			      	<div class="col-xs-12">
			      		<ul id="units-search-no-results" class="search-no-result"></ul>
			      	</div>
				    </div>
			    </div>
		    </div>
			  
			<!-- <div class="col-xs-11"> -->
				<%= form_tag '/buildings', method: :post, id: 'new_building', class: "#{ params[:results].present? ? '' : 'hide' }" do %>
					<%= hidden_field_tag :contribution, 'building_review', class: 'form-control building_contribution' %>
					<%= render partial: 'buildings/building_contribute_form' %>
					<div class="col-sm-12">
				    <div class="pull-right">
			      	<%= submit_tag 'Next', class: 'btn btn-primary', id: 'new_building_submit' %>
			      </div>
			    </div>
				<%end%>
			<!-- </div> -->
			
				<div class="col-xs-12 col-sm-12">
					<%= render partial: 'units/unit_contribute_form', locals: { page: '' }  %>
				</div>
			</div>
		<!-- </div> -->
	</div>
</div>

<script type="text/javascript">
  $(function() {
    new app.buildings;
    var building_id = $("#buildings-search-txt").data('buildingid');
    if(building_id != ''){
	    new app.units(building_id)
	  }
  });
   
</script>