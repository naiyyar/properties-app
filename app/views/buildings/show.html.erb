<div id="street_view_btn" class="hidden-xs">
  <input type="button" id="toggleStreetView" value="Street View" class="btn btn-info"></input>
</div>
<div id="mapView" class="mob-min"><div class="mapPlaceholder"><span class="fa fa-spin fa-spinner"></span> Loading map...</div></div>
<div id="pano"></div>

<div id="content" class="mob-max">
  
  <div class="singleTop">
    <%= render partial: 'building_summary' %>
    <% if @building.uploads.present? %>
      <!-- for Lasrge devices -->
      <div class="row">
        <div class="col-lg-12 col-sm-12 col-xs-12">
          <%=render partial: 'uploads/mobile_touch_slider', locals: { object: @building }%>
          <%= render partial: 'uploads/show_page_slider', locals: { object: @building, path: new_building_upload_path(building_id: @building) } %>
        </div>
      </div>
    <%else%>
      <div class="sliderLink">
        <span class="text-danger">No photos are available.</span>
        <%#= render partial: 'uploads/upload_link', locals: { object: @building }%>
      </div>
    <%end%>
  </div>

  <%= render partial: 'building_amenities' %>

  <div class="clearfix"></div>

  <div class="tabsContainer" style="margin-top: 8px;" id="reviewsContainer">
    <ul class="nav nav-tabs nav-justified" role="tablist">
      <li class="active"><a href="#buildings" role="tab" data-toggle="tab"><%= "BUILDING REVIEWS (#{ @building.reviews.count })"%></a></li>
      <li><a href="#unit_reviews" role="tab" data-toggle="tab"><%= 'UNIT REVIEWS'%> (<%= @unit_review_count %>)</a></li>
      <li><a href="#rent_amount" role="tab" data-toggle="tab"><%= 'RENT INFORMATION'%> (<%= @unit_rent_summary_count %>)</a></li>
      <li><a href="#units" role="tab" data-toggle="tab"><%= 'UNITS'%> (<%= @building.units.count %>)</a></li>
    </ul>
    
    <div class="tab-content">
      <div class="tab-pane fade in active" id="buildings">
        <div class="comments">
          <% @building.reviews.order('created_at desc').each do |review| %>
            <%= render partial: 'reviews/reviews', locals: { review: review, reviewable: @building } %>
          <% end %>
        </div>
      </div>

      <div class="tab-pane fade" id="unit_reviews">
        <div class="comments">
          <% @building_units.each do |unit| %>
            <h3 class="unit_name_header"><%= link_to unit.name, unit_path(unit) %> (<span><%=unit.reviews.count%></span> Reviews)</h3>
            <% unit.reviews.order('created_at desc').each do |review| %>
              <%= render partial: 'reviews/reviews', locals: { review: review, reviewable: unit } %>
            <%end%>
          <% end %>
        </div>
      </div>

      <div class="tab-pane fade" id="rent_amount">
        <%= render partial: 'rent_amount' %>
      </div>

      <div class="tab-pane fade" id="units">
        <%= render partial: 'units' %>
      </div>
    </div>
  </div>
</div>

<div data-map="<%= @gmaphash.to_json %>" id="mapHash" data-lat="<%= @lat.to_json %>" data-lng="<%= @lng.to_json %>"></div>
<div class="addNewUnit">
  <%= render partial: "new_unit_modal" %>
</div>

<% if session[:after_conribute].present? %>
  <%= render partial: 'contribute_more_popup' %>
  <script type="text/javascript">
    window.onload = function(){
      $("#contribute_more").modal('show');
    }
  </script>
  <% session[:after_conribute] = nil %>
<%end%>

<script type="text/javascript">
  $("#new_unit_modal .close").click(function(){
    var search_field = $("#new_unit_modal #units-search-txt");
    if(search_field.val() != ''){
      search_field.val('');
    }
    if(!$('#new_unit_building').hasClass('hide')){
      $('#new_unit_building').addClass('hide');
    }
    if($(".no-result-li").length > 0){
      $(".no-result-li").remove();
    }
  })

  $('.add_unit').click(function(){
    if($("#units-search-txt").hasClass('hide') && $(".unit-search").hasClass('hide')){
      $("#units-search-txt").removeClass('hide');
      $(".unit-search").removeClass('hide');
    }
  })
</script>

<style type="text/css">
  .gm-iv-address-link {
      margin-top: 15px;
      background-color: #ddd;
      padding: 4px;
   }
</style>
