<!DOCTYPE html>
<html>
  <head>
    <%= render partial: 'layouts/layout_head', locals: { js_path: 'home/jquery.init' } %>
    <%= javascript_include_tag 'building/main', async: true, defer: true %>
    <%= javascript_include_tag 'home', async: true, defer: true%>
    <%= layout_stylesheet_link 'building/main' %>
  </head>
  
  <body class="no-hidden touch-scroll" >
    <%= render partial: 'layouts/shared/flash_messages', flash: flash  %>
    <%= render partial: 'layouts/shared/left_side' unless screen_class == 'screen-lg' %>
    <div id="apt-ajax-loader" style='display: none;'><div><span class="fa fa-spin fa-4x fa-spinner"></span></div></div>
    <% unless hide_search_bar? %>
      <%= render 'layouts/shared/wrapper' %>
    <%else%>
      <%= render partial: 'layouts/home/header' if hide_search_bar? %>
      <div class="content-wrapper <%= controller_name + action_name %>">
        <%= yield %>
      </div>
      <%= render 'layouts/home/footer' if show_full_width_footer? && !contribute_page? %>
    <%end%>

    <%= render 'layouts/shared/signin' %>
    
    <div id="remote-container"></div>
    <div id="auth-form"></div>

    <%= javascript_include_tag 'home/main'%>
    <%= render 'buildings/favourite_script' %>
    <%= render 'buildings/show/map_script' %>

    <script type="text/javascript">
      $(function(){ new app.apartments; })
      // hiding autocomplete search results when no input given
      if($('#buildings-search-txt').length > 0){
        $(document).on('keyup', '#buildings-search-txt', function(e) {
          q = $(this).val();
          if (q == '') {
            $(".ui-autocomplete").hide();
            $(".no-match-link").addClass('hidden');
          }
        })
      }
      var slides_to_show = 1;
      if(!Device.type.mobile){
        slides_to_show = 2;
      }
      Card.initSlick(slides_to_show)
    </script>

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=<%=ENV['GOOGLE_TRACKING_ID']%>"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', "<%=ENV['GOOGLE_TRACKING_ID']%>");
    </script>
  </body>
</html>
