<!-- <script src="//cdn.rawgit.com/mahnunchik/markerclustererplus/master/dist/markerclusterer.min.js"></script> -->
<!-- <input type="text" name="zoom" class="hidden zoom" value="<%#=@zoom || 13 %>" /> -->
<!-- <input type="text" name="show_redo" class="hidden show_redo" value="0" /> -->
<%#= content_tag 'div', '', id: 'json-hash', data: { buildingsHash: @hash.to_json }%>
<%#= content_tag 'div', '', id: 'lat', data: { lat: @lat.to_json }%>
<%#= content_tag 'div', '', id: 'lng', data: { lng: @lng.to_json }%>
<%#= content_tag 'div', '', id: 'lng', data: { lng: @lng.to_json }%>
<%#= content_tag 'div', '', id: 'boundary_coords', data: { coords: @boundary_coords.to_json }%>

<%#= hidden_field_tag :searched_by, params[:searched_by] %>
<%#= hidden_field_tag :search_term, params[:search_term] %>
<%#= hidden_field_tag :search_string, @search_string %>
<%#= hidden_field_tag :cu, current_user.present? ? current_user.id : nil %>

<script type="text/javascript" charset="utf-8">
  // if(false){
    // json_array = <%#= raw @hash.to_json %>;
    // var position;
    // var map;
    // var redo_search = false;
    // var currentLocation;
    // var props;
    // var bounds;
    // var infobox;
    // var newMarker;
    // var markers;
    // var options;
    // var controlUI;
    // var controlText;
    // var centerControlDiv;
    // var centerControl;
    // var zoom = <%#= @zoom || 13 %>;
    // var zoomLevel = zoom;
    // var dragged = false;
    // var draggedOnce = false;
    // var lat = <%#= raw @lat.to_json %>; 
    // var lng = <%#= raw @lng.to_json %>;
    // var serched_by = "<%#=params[:searched_by]%>";
    // var searched_term;
    // var city = '';
    // var header_id = $('#header').length > 0 ? 'header' : 'header-mob'
    <%# if params[:search_term].present? %>
      // searched_term = <%#= raw @search_string.to_json %>;
      // if(searched_term != null && searched_term == 'Little Italy'){
        // var city = <%#= raw params[:search_term].include?('newyork') ? 'New York'.to_json : 'Bronx'.to_json %>
      // }
    <%#end%>
    // current_user_id = $('#cu').val();
    // var width = window.innerWidth;
    // var per_page_buildings = [];
  

  // $('.search-view-card').each(function(i, j){
  //   var agentid = $(j).data('agentid');
  //   if(agentid != undefined){
  //     Card.loadFeaturedAgentImagesAndCTALinks(agentid);
  //   }else{
  //     Card.loadDisplayImageAndCTALinks($(j).data('bid'));
  //   }
  // });
// }
  
  // Initialize the map
  //google.maps.event.addDomListener(window, 'load', initialize);

</script>
<%#= javascript_include_tag 'search/map', defer: true, async: true %>
<!-- <script src="//maps.google.com/maps/api/js?v=3.36&key=<%##=ENV['GEOCODER_API_KEY']%>&libraries=places&callback=initialize" async defer></script> -->