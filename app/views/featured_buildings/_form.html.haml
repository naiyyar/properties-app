.form-container
  .row
    .col-xs-12.col-sm-12.col-md-12.col-lg-6
      .panel.panel-default
        .panel-heading
          %b= @featured_building.new_record? ? 'New Featured Building' : 'Edit Featured Building'
        .panel-body
          = form_for @featured_building, html: {class: 'featured_building_form'} do |f|
            .row
              .col-xs-12.col-sm-12.col-md-12.col-lg-12
                .form-group
                  %label Feature This Building
                  = text_field_tag 'featured_building_field', @featured_building.building.present? ? @featured_building.building.building_name_or_address : nil, class: 'form-control buildings-search-txt', placeholder: 'Search building by name or address', data: { src: '/buildings/contribute?featured_as=true' }, :autocomplete => :off
                  #as-comp-buildings-search-results.results{style: "position: relative;"}
                  
              = f.hidden_field :building_id
              = f.hidden_field :featured_by, value: params[:type].present? ? 'manager' : 'admin' if @featured_building.new_record?
              = f.hidden_field :user_id, value: current_user.id if current_user.present?
            
            - if @featured_building.draft_edit?
              - submit_text = 'Save'
              .row
                .col-xs-6.col-sm-6.col-md-6.col-lg-6
                  .form-group
                    %label Start Date
                    = f.text_field :start_date, value: f.object.start_date.present? ? f.object.start_date.strftime("%Y-%m-%d") : nil,  class: 'form-control datepicker', :autocomplete => :off, disabled: @featured_building.featured_by_manager?

                .col-xs-6.col-sm-6.col-md-6.col-lg-6
                  .form-group
                    %label End Date
                    = f.text_field :end_date, value: f.object.end_date.present? ? f.object.end_date.strftime("%Y-%m-%d") : nil,  class: 'form-control datepicker', :autocomplete => :off, disabled: @featured_building.featured_by_manager?
              .row
                .col-xs-6.col-sm-6.col-md-6.col-lg-6
                  .form-group
                    %label Featured Building Renewal
                .col-xs-6.col-sm-6.col-md-6.col-lg-6
                  .form-group
                    .pull-right
                      %input.apple-switch.sb-sm.feature-building.renew{type: 'checkbox', checked: @featured_building.renew, style: 'margin: 0px;', 'data-field' => 'renew', 'data-fbid' => @featured_building.id }
              .row
                .col-lg-12
                  %label When active, the card on file wil be charged $49.00 two days before the end date for the next four week feature cycle.
            
            -else
              - submit_text = 'Next'
              %p The building selected for featuring can be changed at any time while the featuring is still active. For example, if a selected featured building no longer has vacancies, you have the ability to choose a different building that has vacancies using the same feature entry.
              %br
              %p
                %b Payment
              %p= "We will charge you #{number_to_currency(Billing::PRICE)} for four weeks of featuring."
              %p Featuring will be renewed for the next four week cycle two days before the feature end date. The renewal setting can be adjusted at any time through our Manager Tools by editing the featured entry.
              %p 
                We do not offer refunds. Please review our full 
                %a.hyper-link{href: '/terms_of_service', target: '_blank'} Terms of Service
            
            .form-group
              .col-md-7.col-sm-7.col-xs-7
                .pull-right
                  -if @featured_building.new_record?
                    = link_to 'Cancel', params[:type].blank? ? featured_buildings_path : managertools_user_path(current_user, type: 'featured'), class: 'btn btn-default'
                  -else
                    = link_to 'Cancel', !@featured_building.featured_by_manager? ? featured_buildings_path : managertools_user_path(current_user, type: 'featured'), class: 'btn btn-default'
              .col-md-5.col-sm-5.col-xs-5
                = f.submit submit_text, class: 'btn btn-primary btn-block', disabled: true
    

:javascript
  $(function() {
    new app.AsCompBuildings;
  });

  $(document).on('keyup', function(e){
    if(e.keyCode == 40 || e.keyCode == 38){
      if(!$("ul.ui-autocomplete").is(":visible")) {
        //#ui-id-1: becasue there are two 1. global search 2. for buildings search
        $("#ui-id-1").show();
      }
    }
  })