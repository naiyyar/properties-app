function loadMarkerWindow(building_id, map, marker, current_object_type){
  var filter_params = {
    amenities:        $('#list_amenities').val(),
    listing_bedrooms: $('#list_bedrooms').val(),
    min_price:        $('#list_min_price').val(),
    max_price:        $('#list_max_price').val(),
  };
  $.post('/load_infobox', {
    object_id:       building_id, 
    building_show:   false,
    current_user_id: current_user_id,
    filter_params:   filter_params,
    property_type:   current_object_type
  }, function(data){
    infobox.setContent(data.html);
    openInfoBox(map, marker);
  });
}

function openInfoBox(map, marker){
  infobox.open(map, marker);
}

function bindElemToMarker(elem, marker, object, map){
  var price = (object.price == '' || object.price == null) ? 0 : object.price
  var card = elem.parent().parent().parent();
  card.on('mouseover', function(){
    marker.setIcon(markerIcon(price, 'green'));
  }).on('mouseout', function(){
    marker.setIcon(markerIcon(price, 'red'));
  });
};

function createSidebar(object, marker, map, zoom){
  var elem;
  elem = $( createSidebarElemForBuilding(object) );
  // if(object.property_type == 'Building'){
  //   elem = $( createSidebarElemForBuilding(object) );
  // }else{
  //   elem = $( createSidebarElemForFeaturedListing(object) );
  // } 
  
  $('#building_details'+object.id).html(elem);
  bindElemToMarker(elem, marker, object, map, zoom);
};

function createSidebarElemForBuilding(json){
  var building_name = ''
  var address = json.building_street_address;
  if(json.building_name == undefined || json.building_name == ''){
    building_name = address;
  }else{
    building_name = json.building_name
  }

  var city = json.city;
  var state = json.state;
  var zipcode = json.zipcode;
  var full_address = address+','+' '+city+','+' '+state+' '+zipcode;

  if(building_name == ' '){
    building_name = address
  }
  
  return ("<h2>" + building_name + "</h2>" +
  "<div class='cardAddress'><span class='fa fa-map-marker'></span> "+full_address+"</div>" );
};

// function createSidebarElemForFeaturedListing(object){
//   return header_elem(object.rent, object.full_address)
// }

// function header_elem(title, subtitle){
//   ("<h2>" + title + "</h2>" +
//   "<div class='cardAddress'><span class='fa fa-map-marker'></span> "+subtitle+"</div>" );
// }

function markerIcon(price, type='red'){
  var path = $('#red-marker-asset-'+0);
  var img_name;
  var red_img_path;
  var green_img_path;
  for(i=0; i <= 4; i++){
    if(price == i){
      if(type == 'red'){
        path = $('#red-marker-asset-'+i).data('path');
      }else{
        path = $('#green-marker-asset-'+i).data('path');
      }
    }
  }
  return path
}
